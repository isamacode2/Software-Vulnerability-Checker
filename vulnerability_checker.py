import vulners

# Initialize the Vulners API with your actual API key
vulners_api = vulners.Vulners(api_key="Y97WQCKE9J8HJIA0C42U79AK4MB0EZEAKRPLNMOTDVHA9H0BMP4EU2BQ9N9UXCPX")

def check_vulnerabilities(software_name, software_version):
    vulnerabilities_list = vulners_api.softwareVulnerabilities(software_name, software_version)
    exploit_list = vulnerabilities_list.get('exploit')
    vuln_list = vulnerabilities_list.get('vulnerabilities')
    if vuln_list:
        print("Vulnerabilities for {} {}:".format(software_name, software_version))
        for vuln in vuln_list:
            print("- {}".format(vuln.get('id')))
    if exploit_list:
        print("Exploits for {} {}:".format(software_name, software_version))
        for exploit in exploit_list:
            print("- {}".format(exploit.get('id')))

software_versions = {
    "Windows 10": "22H2",
    "Ubuntu": "20.04.2 LTS",
    "CentOS": "7 (2009)",
    "Apache": "2.4.46",
    "Nginx": "1.19.2",
    "MySQL": "8.0.21",
    "MongoDB": "4.4",
    "PHP": "8.1.27",
    "Python": "3.10.4",
    "WordPress": "5.7.2",
    "Joomla": "3.9.28"
}

if __name__ == "__main__":
    for software, version in software_versions.items():
        check_vulnerabilities(software, version)

